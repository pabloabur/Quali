\chapter{METODOLOGIA}
Em todas as simulações descritas a seguir, foi utilizado o método de 
integração numérica de Runge-Kutta de quarta ordem e com passo de
integração de 0.05 ms. Os dados obtidos podem ser acessados por meio
do link: \url{https://dx.doi.org/10.17605/OSF.IO/QNMBH}. Os códigos
desenvolvidos para realizar as simulações e processar os resultados,
por sua vez, podem ser encontrados no GitHub:
\url{https://github.com/pabloabur/projectFR/tree/masters}.

\section{Desempenho computacional}
Duas abordagens distintas foram consideradas nessa parte: A utilização de um 
\textit{cluster} e o Python na sua implementação original (CPython).
As medições do tempo de execução, realizadas por meio da biblioteca \textit{time},
levaram em conta apenas os trechos do código
que se repetem várias vezes e que, consequentemente, contém os maiores
``gargalos'' na simulação.

Vale notar que, na época da escrita dessa seção e dos resultados 
obtidos, a versão do ReMoto em Fortran ainda não estava disponível.
Dessa forma, apenas aqui e na sessão \ref{sec:res_perf}, a versão
utilizada do ReMoto foi a em Python.

\subsection{Cluster Águia}
O \textit{cluster} Águia é composto por 64 servidores físicos com 20 \textit{cores} e 
512 GB de RAM. Seu processador é um Intel(R) Xeon(R) CPU E7-2870 com 2.4 GHz.
A versão do Python disponível para utilização nesse sistema é 2.7.13, da
distribuição Anaconda2 4.4.0.

Primeiramente, o uso de ferramentas para passagem de mensagens em um sistema
distribuído será analisado para simulações simples, com uma corrente injetada
de 10 nA no soma de MNs. O cálculo da força gerada também será computado.
Para esse fim, o pacote
Python MPI4Py, que possibilita o uso do todos os recursos do \textit{cluster},
será utilizado. Serão utilizados 2, 4, 8 e 16 processos em um único servidor.

Para possibilitar que o problema abordado pudesse ser divididos em unidades menores
de computação, foram identificados algumas \textit{tasks} primitivas: os cálculos
da força e das equações diferenciais das unidades motoras. As unidades
motoras são independentes entre si e não precisam receber mensagens durante a
simulação, mas a parte de cálculo de força precisa receber, a cada passo de
tempo, valores relativos de disparos das unidades motoras. Sendo assim,  as
unidades motoras enviam, no final de cada passo da simulação,
seus valores de disparos para as \textit{tasks} de cálculo de força, que
apenas as recebem e realizam suas computações.

As computações das unidades
motoras serão divididas igualmente entre os processos criados, 
enquanto que a \textit{task} de cálculo da força deve ocupar sozinha um único
processo. Os parâmetros que serão usados para analisar a qualidade do programa
paralelo são o \textit{Speedup} (ou aceleração, em português) \speedUp,
calculado pela equação

\begin{equation}
    \speedUp = \frac{\tempSer}{\tempPar},
\label{eq:speedup}
\end{equation}

em que $t_s$ e $t_p$ são o tempo de execução serial e paralelo,
respectivamente, e a eficiência \Eff, calculada por

\begin{equation}
    E = \frac{t_s}{N_{proc}t_p},
\end{equation}

sendo \numProc o número de processadores utilizados \cite{grama03}.

Os valores de $t_s$ e $t_p$ são obtidos a partir da média de 10 simulações com
400 unidades motoras e duração de 0.5 segundos.

\subsection{Python}
Essa estratégia se baseia no uso do conceito de vetorização. O código atual 
utiliza uma matriz de condutâncias de cada compartimento do modelo para
realizar cálculos sobre os potenciais de membrana. O objetivo é criar uma
matriz maior que contenha cada uma dessas matrizes menores, de forma que o 
processo de vetorização possa trazer otimizações. Isso será realizado para 
todos os MNs, INs e algumas outras variáveis envolvidas no cálculo do potencial
de membrana. A implementação antiga das matrizes será identificada como \Ga e
a nova proposta, como $G_n$.

Nessa parte será utilizado um sistema operacional Linux
64 bits com oito processadores Intel Core i7-2600 a 3.40 GHz e 7.8 GB de RAM.
A versão do Python utilizada é a 2.7.14, da distribuição Anaconda2 5.0.1-1.
De forma geral, as simulações consistirão de comandos descendentes ativando
MNs.
O tempo de execução será obtido a partir da média de 5 resultados
para diferentes quantidades de MNs
(variação no tamanho da matriz de condutância).

\section{Estudo das parametrizações}
Os dados utilizados aqui vêm
de experimentos realizados em membros inferiores de gatos por que estudos
experimentais ou computacionais sobre o circuito de inibição recorrente
em seres humanos são escassos e indiretos. Todas as simulações foram
realizadas com o ReMoto versão Fortran em um computador com sistema
operacional Linux 64 bits com oito processadores Intel Core i7-2600
a 3.40 GHz e 7.8 GB de RAM. Os dados foram processados e analisados com
Python versão 3.7.3.

\subsection{Parametrização do modelo de motoneurônios}
O modelo adotado foi o de um núcleo motor do músculo gastrocnêmios 
medial do gato. Em simulações envolvendo populações desses neurônios,
foi considerado um comprimento de 6 mm do núcleo motor \cite{burke77}
com 75 MNs do tipo S, 75 do tipo FR e 150 do tipo FF, como em
\citeonline{uchiyama03a}. Fibras descendentes responsáveis pela
ativação do núcleo motor foram modeladas no ReMoto como 400 elementos pré-
sinápticos disparando potenciais de ação de acordo com um processo pontual
Gama e com 30\% de conectividade com o compartimento dendrítico dos MNs.
A ordem desses processos estocásticos em função do nível de força estudado
foi adotada como no trabalho de \citeonline{watanabe13}.

Os valores de pico dos \textit{twitches} e força tetânica das unidades
motoras utilizados foram os publicados por \citeonline{mrowczynski06},
considerando que os limites dos intervalos fornecidos estivessem 
relacionados linearmente com o tamanho dos MNs. A partir disso, as
relações \textit{twitch}-tétano foram calculadas para cada MN como
o valor da força tetânica divido pela amplitude de pico do \textit{twitch}.

Também considerando uma distribuição de parâmetros que acompanham
linearmente o tamanho do MN, o tempo que o \textit{twitch} leva para
alcançar o pico e a velocidade de condução axonal foram interpolados
a partir dos valores máximos e mínimos fornecidos em
\citeonline{burke71} e \citeonline{zengel85}, respectivamente.

No ReMoto, a saturação da força das unidades motoras se dá por
meio de uma sigmoide. Dessa forma, também foi necessário encontrar
uma constante de saturação que fizesse com que essa função, para
cada MN, tivesse como saídas o recíproco da relação
\textit{twitch}-tétano e 1 quando as entradas fossem iguais a 1 e a 
força tetânica, respetivamente.

Existem outros parâmetros do modelo de MN no ReMoto, mas esses
não foram alterados ou por que a parametrização adequada já foi feita
\cite{cisi07} ou por que não influem nas simulações realizadas. Os
dados experimentais utilizados e suas referências são apresentados
na Tabela \ref{tab:met_MNparams}.

\begin{table}[ht!]
\caption[Dados experimentais de unidades motoras utilizados na parametrização dos MNs.]{Dados experimentais de unidades motoras utilizados na parametrização dos MNs. Os valores,
    fornecidos na forma de intervalos, foram distribuídos linearmente pelo núcleo motor de acordo
    com os tamanhos dos MNs. Referências: (a) \citeonline{mrowczynski06}, (b) \citeonline{burke71}
    e (c) \citeonline{zengel85}.}
\label{tab:met_MNparams}
\centering
    \begin{tabu}{p{6.4cm} c c c c}\tabucline[1.5pt]{-}
        \multirow{2}{*}{Propriedades} & \multicolumn{3}{c}{Unidades motoras} &
            \multirow{2}{*}{Referência} \\
        & FF & FR & S & \\ \tabucline[1.5pt]{-} 
        \textit{Twitches} (mN) & 12 até 380 &
            2 até 74 & 2 até 53 & (a) \\
        Forças tetânicas (mN) & 30 até 1032 & 37 até 570 & 17 até 396 &
        (a) \\
        Tempos de contrações (ms) & 20 até 47 &
            30 até 55 & 58 até 110 & (b) \\
        Velocidade de condução axonal (m/s) & 99$\pm$ 1 & 100$\pm$ 1 & 86$\pm$ 1 &
            (c) \\
	\hline
    \end{tabu}
\end{table}

\subsection{Parametrização do modelo de célula de Renshaw}
As parametrizações foram efetuadas na ordem em que são apresentadas
e iterativamente, com base nos conhecimentos sobre a CR ou o circuito
de inibição recorrente descritos na literatura.
Como a estimativa é de que existam em média
100 CRs para cada 1 mm de extensão da medula espinhal do gato \cite{carr98},
simulações do núcleo motor inteiro foram realizadas com 600 CRs.
Os demais parâmetros, quando não mencionados na metodologia, foram mantidos 
de acordo com o que foi descrito em \citeonline{cisi07}.

\subsubsection{Potenciais excitatórios pós-sinápticos}
Mantendo-se o padrão de $C_m = \text{1 }\mu\text{Fcm}^{-2}$,
a resistência específica foi ajustada para reproduzir os 
seguintes resultados descritos na literatura:

\begin{enumerate}[label=\alph*)]
    \item \citeonline{walmsley81}: Medições da atividade intracelular em
        CRs após uma estimulação de raízes ventrais forneceram alguns
        dados sobre os PEPSs resultantes, como mostrado na Figura
        \ref{fig:PEPS};
    \item \citeonline{williams09}: Nesse trabalho de simulações, os
        autores adotam 7.6 ms de tempo de subida
        e 50 ms de duração dos PEPSs descritos por \citeonline{walmsley81}.
\end{enumerate}

\begin{figure}[ht]
	\center
	\includegraphics[scale=0.7]{PEPS}
	\caption{Potencial excitatório pós-sináptico recorrente em uma
             célula de Rewshaw \cite{walmsley81}.}
	\label{fig:PEPS}
\end{figure}

Para simular o experimento descrito, uma corrente suficiente para causar
um único potencial de ação foi injetada no soma de um
MN do tipo S que fazia sinapse com uma CR. Para garantir uma atividade
passiva da membrana, a condutância sináptica ativada pelo disparo do MN
foi diminuída.

\subsubsection{Características de disparos}
Os parâmetros de limiar, comprimento, diâmetro e densidade e variáveis de
transição das condutâncias iônicas do modelo da CR podem ser alterados
para reproduzir diferentes características de disparos. As alterações feitas 
foram baseadas nas seguintes referências:

\begin{enumerate}[label=\alph*)]
    \item \citeonline{walmsley81}: Foi mostrado que CRs disparam
        espontaneamente a uma taxa de 7 pps;
    \item \citeonline{hultborn79}: Relações de frequência de disparo
        \textit{versus} corrente injetada ($\freq\times\iinj$) foram obtidas para 
        diferentes correntes, como visto na Figura
        \ref{fig:HP79}\subref{fig:fxiRC}. Nessas curvas, informações sobre
        a forma como a CR se adapta a uma dada corrente e a intensidade 
        de corrente necessária para que os disparos comecem a acontecer
        também podem ser extraídas. Além dessas contribuições, os autores
        mostraram que, após um breve pulso de corrente injetada,
        a AHP apresentou uma amplitude de -2 mV e duração por volta de 30 ms,
        como visto na Figura \ref{fig:HP79}\subref{fig:AHPRC};
    \item \citeonline{fyffe90}: Estudos morfológicos mostraram CRs com 
        diâmetro médio de de 27 $\mu$m;
    \item \citeonline{bui03}: Estimativas da área superficial média do soma
        e do dendrito foram 1753.8 $\mu\text{m}^2$ e 16756 $\mu\text{m}^2$,
        respectivamente.
\end{enumerate}

\begin{figure}[ht]
    \centering
    \subfloat[][]{
        \label{fig:fxiRC}
        \includegraphics[scale=0.4]{fxiRC}
    }
    \hspace{-1cm}
    \subfloat[][]{
        \label{fig:AHPRC}
        \includegraphics[scale=0.5]{AHPRC}
    }
    \caption[Características de disparos disparos da célula de Renshaw
            \cite{hultborn79}]{
        Características de disparos disparos da célula de Renshaw
        \cite{hultborn79}. \subref{fig:fxiRC} Relação entre corrente
        injetada e taxa de disparo de uma célula de Renshaw.
        A taxa de disparo instantânea entre o primeiro e segundo potencial
        de ação é entendido como o 
        primeiro intervalo, e assim por diante. O regime estacionário foi
        considerado como sendo após 80 ms. 
        \subref{fig:AHPRC} Detalhes de
        amplitude e duração da pós-hiperpolarização.
}
    \label{fig:HP79}
\end{figure}

Primeiramente, é necessário definir quando a CR irá disparar
um potencial de ação. Sabe-se que esses neurônios possuem
baixo limiar \cite{uchiyama03a}, mas não existem estudos quantitativos
especificamente sobre esse parâmetro. O valor do limiar foi calculado como

\begin{equation}
\thresh=\frac{\rheo R_m}{\supArea}
\label{eq:vth}
\end{equation}

com $V_l$ sendo a tensão de limiar, $I_r$ a corrente de reobase e $a$ a 
área superficial total \cite{cisi07}. Para calcular o comprimento \length de um
único compartimento, por sua vez, foi usada a expressão

\begin{equation}
    a=\pi ld
    \label{eq:area}
\end{equation}

sendo \diam o diâmetro da CR \cite{sterratt11}.

A partir de então, simulações foram realizadas com diferentes valores de
variáveis de transição e densidade das condutâncias iônicas de uma única CR
para se encontrar resultados de AHP e curva $F\times I$ apropriados. As correntes
injetadas em cada caso estiveram de acordo com os dados mostrados na Figura
\ref{fig:HP79}. Por fim, para obter uma taxa de disparos espontâneos de 7 pps,
foi necessário alterar o valor da condutância máxima do ruído agindo sobre
a CR.

\subsubsection{Potenciais inibitórios pós-sinápticos}
As condutâncias sinápticas ativadas pelos disparos das CRs em cada
tipo de MN foram ajustadas, levando em conta os seguintes dados experimentais:

\begin{enumerate}[label=\alph*)]
    \item \citeonline{friedman81}: Correlações foram encontradas entre
        amplitude dos PIPS e o tipo do MN, mas não entre amplitudes e 
        as resistências de entrada dos MNs em cada tipo;
    \item \citeonline{fyffe91}: Conexões sinápticas identificadas como
        provenientes de CRs foram todas localizadas nos dendritos de MNs
        do tipo alfa;
    \item \citeonline{uchiyama03a}: Baseado em dados fisiológicos
        \cite{friedman81,hultborn88b,vankeulen79}, um procedimento para
        estimar PIPS nos MNs de um núcleo motor foi adotado, tendo os 
        resultados mostrados na Figura \ref{fig:met_IPSP}.
\end{enumerate}

\begin{figure}[ht]
	\center
	\includegraphics[scale=0.4]{met_IPSP}
    \caption[PIPS resultante agindo nos MNs]{
             PIPS resultante agindo nos MNs \cite{uchiyama03a}.
            }
	\label{fig:met_IPSP}
\end{figure}

Sendo assim, a localização das sinapses das CRs foi definida no
compartimento dendrítico do MN e simulações foram realizadas para encontrar
três valores de condutâncias (um para cada tipo) que reproduzam a Figura 
\ref{fig:met_IPSP}.

\subsubsection{Distribuição de potenciais inibitórios pós
               -sinápticos recorrentes}
                \label{sec:met_ipsp}
A distribuição dos PIPS recorrentes pelo núcleo motor depende 
de fatores topográficos e funcionais. No ReMoto, isso está relacionado
com condutâncias sinápticas e suas conexões. Nas simulações realizadas,
a conectividade entre MNs e CRs foi considerada como sendo de 
100\% e as condutâncias e suas distribuições topográficas são parametrizadas
de acordo com:

\begin{enumerate}[label=\alph*)]
    \item \citeonline{mccurdy94}: A Distribuição topográfica das amplitudes
        significativas de PIPS recorrentes obtida de pares de MNs é
        inversamente correlacionada com a distância. Os autores fornecem uma
        visão geral, independente do núcleo motor. MNs do músculo gastrocnêmio
        medial separados por no máximo 1 mm são classificados como 
        próximos. Fora dessa zona, são considerados distantes. A Figura
        \ref{fig:met_RIPSP} mostra o resultado dos autores. Para o músculo
        em questão, os valores médios de amplitudes foram de 
        -19,63 $\pm$ 2,42 $\mu$V e -41.36 $\pm$ 7.19 $\mu$V para pares
        distantes e próximos, respectivamente;
    \item \citeonline{uchiyama03a}: O padrão de distribuição topográfica 
        da força sináptica é o de uma gaussiana que decresce na medida
        em que se afasta do neurônio pré sináptico. O desvio padrão da
        curva é de 0.167 mm e 1.164 mm para os MNs e para as CRs, 
        respectivamente. A quantidade de botões sinápticos também é
        um indicativo da força sináptica das conexões. Estima-se que os
        axônios colaterais dos MNs que alcançam a região onde as CRs se
        encontram possuam 78.5 $\pm$ 7.5, 43.0 $\pm$ 4.2 e 35.5 $\pm$ 3
        destes botões sinápticos se forem do tipo FF, FR e S, respectivamente.
\end{enumerate}

\begin{figure}[ht]
	\center
	\includegraphics[scale=0.4]{met_RIPSP}
    \caption[Distribuição topográfica de PIPS recorrentes]{
             Distribuição topográfica de PIPS recorrentes. Valores
             na abcissa indicam a distância entre os pares de MNs
             enquanto que a ordenada mostra o valor da amplitude do 
             PIPS recorrente gerado. Pontos pretos e brancos representam as respostas
             significantes e as possivelmente equívocas, respectivamente
             \cite{mccurdy94}.}
	\label{fig:met_RIPSP}
\end{figure}

Para reproduzir o experimento como em \citeonline{mccurdy94}, as simulações
consistiram em correntes injetadas no soma de MNs por um curto período de 
tempo para que o PIPS recorrente pudesse ser observado em outros MNs.
Foram levados em conta 180 pares, separados por distâncias entre
86 $\mu$m e 4.7 mm. O número de CRs, de acordo com as estimativas,
foi de 600.

O número
de botões sinápticos de cada tipo de MN nas CRs foi implementado como valores
de condutância seguindo uma proporção de 1:0.55:0.45 (FF:FR:S). Isso
permitiu que apenas a condutância máxima dos MNs do tipo FF
\gmaxff fosse parametrizado, sendo as outras ajustadas
de acordo com a proporção.

\subsubsection{Dinâmica e depressão sináptica}
Para abordar as características dinâmicas e de depressão pós-sináptica,
as referências utilizadas foram:

\begin{enumerate}[label=\alph*)]
    \item \citeonline{hultborn79}: Os autores apresentaram
          evidências da existência de um mecanismo de decréscimo da eficácia
          sináptica dos terminais de axônios colaterais agindo sobre as CRs.
          Essa conclusão foi baseada na diminuição de taxas de disparo para
          diferentes frequências de estímulo;
    \item \citeonline{uchiyama03a}: Um aumento abrupto na frequência de
          estimulação da CR fez com que sua
          taxa de disparo apresentasse um \textit{overshoot}, como
          mostrado na Figura \ref{fig:met_dyn}.
\end{enumerate}

\begin{figure}[ht]
	\center
	\includegraphics[scale=0.4]{met_dyn.png}
    \caption[Características dinâmicas da célula de Renshaw.]{
             Características dinâmicas da célula de Renshaw.
             A frequência do estímulo
             aplicado, inicialmente
             de 5 Hz (com resposta indicada pelo traço horizontal com o
             número 5 no eixo
             vertical), foi abruptamente aumentada para um dos valores
             indicados na legenda, em Hz \cite{uchiyama03a}.
            }
	\label{fig:met_dyn}
\end{figure}

No ReMoto, uma depressão pós-sináptica em função do tempo é descrita por

\begin{equation}
    \gsyn (t)=\gmax-(\gmax-g_{dyn}\vari)e^{-\frac{(\td+t)}{\tau_d}}
\end{equation}

sendo $g_{dyn}$ a condutância dinâmica alterada pela depressão
após um disparo, \gmax a condutância máxima original, \vari o 
quanto de depressão ocorrerá ($0\le\vari\le 1$), \taud a 
constante de tempo e $t_d$ o instante do último disparo.

As simulações para ambas características foram feitas com uma 
população de CRs recebendo um estímulo antidrômico
com frequências variadas para que a taxa de disparos gerada
fosse contabilizada.

\subsection{Validação do modelo}
Nesta seção, de forma qualitativa e
semiquantitativa, a robustez da parametrização adotada foi testada por meio
da comparação de resultados de procedimentos experimentais com resultados
obtidos da simulação desses experimentos.

\subsubsection{Características de potenciais inibitórios
            pós-sinápticos recorrentes}
As características de PIPS recorrentes que foram verificadas 
são mostradas na Figura \ref{fig:met_hamm}. As simulações realizadas 
foram as mesmas da parametrização na Seção \ref{sec:met_ipsp}.

\begin{figure}[ht]
	\center
	\includegraphics[scale=1.3]{met_hamm}
    \caption[Resultados experimentais sobre características de PIPS
            recorrentes.]{
            Resultados experimentais sobre características de PIPS
            recorrentes. Eixos verticais são as contagens de ocorrências
            \cite{hamm87b}.}
	\label{fig:met_hamm}
\end{figure}

\subsubsection{Relação estática das entradas e saídas das células de Renshaw}
A relação estática de entrada e saída realizada por \citeonline{cleveland81}
é importante para a caracterização de CRs. Foi observado que os resultados
obtidos poderiam ser ajustados a uma função hiperbólica, que por
conveniência foi chamada de função de Langmuir pelos autores. Esta abordagem
também foi empregada nesse trabalho e a função em questão foi calculada como

\begin{equation}
    \fcr=\frac{\satConst\fad}{\constSemiSat+f_{AD}}
\end{equation}

em que $f_{AD}$ é a frequência do estímulo, $f_{CR}$ é a taxa de disparo
média da CR após sua resposta transiente,
$c$ é a constante de saturação e $k$ é a 
constante de semissaturação. Esta análise foi reproduzida
no modelo parametrizado, passado um período de adaptação do neurônio 
de 500 ms e 
considerando as frequências de estímulos antidrômicos como entrada e
taxas de disparos das CRs como saída. Os resultados experimentais
da literatura são
os mostrados na Figura \ref{fig:met_cleveland}

\begin{figure}[ht]
	\center
	\includegraphics[scale=1.3]{met_cleveland}
    \caption[Resultados experimentais sobre relações estáticas de 
            entrada e saída.]{
            Resultados experimentais sobre relações estáticas de 
            entrada e saída. Uma frequência de estímulo antidrômica
            $f_{AD}$ em Hz gera uma taxa de disparos $f_{RC}$ na CR.
            No gráfico superior, 24 funções de Langmuir são ajustadas
            às respostas de 24 CRs. No gráfico inferior, a média
            normalizada desse grupo é apresentada, também com uma
            função de Langmuir ajustada a ela. Barras verticais
            representam o desvio padrão.
            \cite{cleveland81}.}
	\label{fig:met_cleveland}
\end{figure}

\subsubsection{Respostas das células de Renshaw sujeitas a um estímulo
            antidrômico}
As CRs, quando ativadas por todos os axônios motores convergindo
nelas, exibem disparos que podem durar até algumas dezenas de
milissegundos e taxas de disparos
instantâneas decrescentes com o tempo e dependentes da força sináptica 
total \cite{eccles61b,uchiyama03a}. Essa característica é mostrada na 
Figura \ref{fig:met_eccles}

\begin{figure}[ht]
	\center
	\includegraphics[scale=1.3]{met_eccles}
    \caption[CRs e sua resposta à um estímulo antidrômico.
            ]{CRs e sua resposta à um estímulo antidrômico.
            O tempo é mostrado na abcissa, em ms, enquanto
            que a taxa de disparos, na ordenada, em pps.
            São mostradas respostas de diferentes núcleos 
            motores, de acordo com a legenda: A, plantar;
            B, sóleo; C, gastrocnêmio medial; D, gastrocnêmio
            lateral \cite{eccles61b}.}
	\label{fig:met_eccles}
\end{figure}

Nas simulações realizadas, a atividade espontânea das CRs foi ativada
e os estímulos antidrômicos foram aplicados com diferentes intensidades
para ativar diferentes tipos de MNs. As taxas de disparos instantâneas
foram calculadas como o recíproco do intervalo entre cada potencial de
ação, em pps.

\section{Efeitos da parametrização em simulações}
Nessa seção, as simulações realizadas
foram configuradas para serem o mais semelhantes possível aos trabalhos
usados como referência para que os resultados pudessem ser apropriadamente
comparados. De formal geral, todas as simulações tiveram
CRs disparando espontaneamente.

\subsection{Disparos de motoneurônios}
\label{sec:met_onion}
Com o intuito de analisar o recrutamento dos MNs,
uma corrente \injCur
em função do tempo foi injetada no soma de todos esses neurônios. Nessa
simulação, a presença ou ausência da inibição recorrente é analisada no
mesmo circuito e a corrente $i(t)$ é descrita pela seguinte equação:

\begin{equation}
    i(t)=40t/1000.
    \label{eq:i}
\end{equation}

Outra opção utilizada para estimular os MNs foi com
uma entrada excitatória que aumenta com o tempo de simulação,
mas, nesse caso, isso se dá por meio de
fibras descendentes com
frequência de disparos \fd dada por

\begin{equation}
FD(t)=1500t/1000.
    \label{eq:fd}
\end{equation}

Em outra situação,
para estudar a taxa de disparos dos MNs, a entrada utilizada
foi dada por

\begin{equation}
    FD(t)=
    \left\{
        \begin{aligned}
            &\frac{\cvmPerc}{4000}t,\quad t\le 4000 ms \\
            &\cvmPerc,\quad 4000<t<5000 ms \\
            &-\frac{\cvmPerc}{4000}(t-9000),\quad t\ge 5000 ms
        \end{aligned}
    \right.
    \label{eq:ramphold}
\end{equation}

sendo \cvmPerc o valor necessário para alcançar a porcentagem da CVM desejada.
Esta equação representa os disparos de fibras descendentes agindo sobre
o núcleo motor com o intuito de realizar uma contração em rampa até 70 \%
da CVM. Após 1 segundo nesse valor, eles decaíram com a mesma derivada.

Nas simulações com inibição recorrente, \cvmPerc de 950 foi suficiente
para recrutar por volta de 240 MNs \cite{walmsley78} no pico da
Equação (\ref{eq:ramphold}). Para fazer com que
o nível de força muscular gerado nessa situação
se mantivesse na ausência das CRs, o valor dessa variável foi
diminuído para 710.

As taxas de disparos foram calculadas por meio da convolução de
uma janela de Hann de 400 ms de largura e área unitária com
um trem de impulsos unitários representando os instantes de 
disparos dos MNs.

\subsection{Diminuições dos níveis de força}
O efeito do modelo de CR na força muscular foi estudado baseando-se
no trabalho de \citeonline{granit61}, que fizeram uma estimativa 
do quanto a inibição recorrente diminuiria a tensão gerado pelo 
músculo sóleo do gato. Isso é mostrado na Figura \ref{fig:met_granit}

\begin{figure}[ht]
	\center
	\includegraphics[scale=0.5]{met_granit}
    \caption[Tensão isométrica do músculo sóleo (ordenada) em função
             da frequência de estímulo do nervo (abcissa).]{
             Tensão isométrica do músculo sóleo (ordenada) em função
             da frequência de estímulo do nervo (abcissa). Os círculos
             preenchidos representam os valores de referência de tensão
             muscular, enquanto que a curva 1 é uma estimativa dessa
             na ausência de inibição recorrente. A curva 2 é a diferença
             das outras duas \cite{granit61}.}
	\label{fig:met_granit}
\end{figure}

Como o músculo utilizado nesse experimento é diferente do empregado
nas parametrizações, algumas considerações foram necessárias.
Foi pressuposto que as relações dos MNs desse núcleo motor
com as CRs e as fibras descendentes (condutâncias sinápticas e conectividade)
sejam as mesmas.
Ademais, as características de unidade motora relacionado aos 
\textit{twitches}, propriedades eletrotônicas e geométricas foram as
mesmas adotadas para o núcleo motor gastrocnêmio medial.
Dessa forma, apenas as quantidades e distribuição de tamanhos
desses neurônios foram alteradas, semelhante ao trabalho de
\citeonline{maltenfort98}.

A simulação, portanto, foi realizada com
150 MNs do tipo S, de acordo com estimativas realizadas em trabalhos 
experimentais \cite{burke11}. Respeitando a proporção de 50 MN/mm de medula
espinhal \cite{cisi07}, esses neurônios foram distribuídos
em 3 mm. Sendo assim, 300 CRs foram dispostos nesse comprimento
\cite{carr98}.
O núcleo motor foi ativado por fibras descendentes durante 4 s,
com taxas suficientes para gerar os níveis
de força reportados na Figura \ref{fig:met_granit}.

A média da força em cada nível de estimulação foi calculada,
descartando 1 s inicial que poderia conter respostas transitórias.
Por estar diretamente
relacionada com a força gerada, a taxa de disparos média dos MNs 
(computada como a média das taxas individuais) e sua diminuição 
causada pela inibição recorrente também foi analisada.

\subsection{Análise espectral da força gerada pelo modelo}
\label{sec:met_psd}
Algumas condições simuladas por \citeonline{williams09},
como explicado  na seção \ref{sec:intro_williams},
foram reproduzidas aqui para verificar se o modelo implementado no
ReMoto era capaz de reduzir oscilações em 10 Hz.

Cada MN foi ativado por fibras descendentes com taxas de disparos
moduladas por
uma senoide com período de 100 ms e valor médio suficiente para gerar
um nível de força desejado. Ruídos excitatórios
nos compartimentos dendríticos dos MNs foram adicionados
por meio de condutâncias sinápticas com valor de pico igual a 12 $\mu$S
ativadas por um processo pontual Poisson.
As frequências dessas duas entradas excitatórias foram determinadas
como mostrado a seguir.

Primeiramente, usando o caso sem inibiç\~{a}o recorrente, a
frequ\^{e}ncia média de disparo de fibras descendentes necessária 
para recrutar cerca de 75 MNs foi determinada. Essa quantidade
foi próxima de
25\% da população de MNs ativados em níveis de força de 5\% da CVM
\cite{hoffer87,walmsley78}. Por causa de fatores como conectividade e
propriedades dos MNs, algumas unidades motoras do tipo
FR foram ativadas. O mesmo procedimento foi realizado para níveis
de 70\% da CVM, mas tendo a atividade de 80\% do núcleo motor como
alvo \cite{hoffer87,walmsley78}.

Em seguida, para cada porcentagem da CVM adotada, foram considerados
cenários com inibição recorrente em que a condutância das CRs
sob os MNs de cada tipo fosse igual, o dobro e a metade dos
respectivos valores apresentados na Tabela \ref{tab:params_final}.
Em cada um desses casos,
frequências médias de disparos foram ajustadas
para fazer com que as m\'{e}dias das forças geradas estivessem
dentro de uma faixa de 10\% em torno da respectiva força gerada
na ausência de CRs.

As frequências médias determinadas anteriormente foram utilizadas como valor
médio de uma senoide, que foi igual para todas as situações simuladas
nessa seção. Sua amplitude pico a pico, determinada na situação
com condutâncias das CRs inalteradas e com 5\% da CVM, 
foi aquela necessária para
fazer com que se fosse 
possível observar picos no espectro da força e na coerência
córtico-muscular parecidos com os de \citeonline{williams09}.

As características das fibras descendentes são
resumidas na Tabela
\ref{tab:met_dcistrat}. Em todos os cenários, a amplitude pico a pico
da senoide
foi de 4.6 Hz. Ademais, um ruído independente com uma taxa pequena
de 90/s, suficiente para gerar cerca de 1/10 da condutância total
causada pelas fibras descendentes no compartimento dendrítico,
foi associado a todos os MNs.

\begin{table}[ht!]
\caption{Valores utilizados para as entradas nas simulações em cada
    uma das situações estudadas.}
\label{tab:met_dcistrat}
\centering
    \begin{tabu}{c c c}\tabucline[1.5pt]{-} 
        \multirow{2}{*}{Situação da inibição recorrente} & \multicolumn{2}{c}{Frequências (Hz)} \\
             & \multicolumn{1}{c}{5\% CVM} & \multicolumn{1}{c}{70\% CVM} \\ \tabucline[1.5pt]{-}
        Ausente & 141 & 665 \\
        Fraca & 190 & 795 \\
        Normal & 230 & 930 \\
        Forte & 333 & 1180 \\
	\hline
    \end{tabu}
\end{table}

Uma outra condição simulada foi uma em que o valor médio da senoide
foi mantido o mesmo sem e com inibição recorrente.
Nesse caso, apenas a situação com 5\% da CVM e condutâncias das CRs
inalteradas foi considerada.

A densidade espectral de potência da força muscular foi estimada por
meio do método de 
Welch \cite{bendat11} com 5 janelas de Hann com 50\% de sobreposição.
A coerência entre o sinal de EMG e o potencial de membrana do dendrito do MN de
índice 1, tomado como representativo da atividade neural descendente
oriunda do encéfalo, foi estimada
da mesma forma, mas com 33 janelas. O MN em questão recebia apenas
as entradas sinápticas excitatórias (potenciais de ação de fibras
descendentes e ruído), não era capaz de gerar potenciais de ação 
e nem de fazer conexões com CRs.

As simulações realizadas tiveram duração de 11 s e passo de
integração de 0.05 ms. Para evitar
interferências de respostas transitórias, apenas os últimos 
10 segundos dos sinais gerados pelo ReMoto foram utilizados.
As simulações foram repetidas dez vezes
para que se fosse obtida uma resposta média dos resultados, que 
foram, então, comparadas qualitativamente com os resultados de
\citeonline{williams09} mostrados na Figura
\ref{fig:met_williams09}.

\begin{figure}[ht]
    \centering
    \subfloat[][]{
        \label{fig:met_williams09a}
        \includegraphics[scale=0.9]{met_williams09a}
    }
    \hspace{-1cm}
    \subfloat[][]{
        \label{fig:met_williams09b}
        \includegraphics[scale=0.4]{met_williams09b}
    }
    \caption[Efeitos da ausência e presença da célula de Renshaw em
            análises espectrais.]{Efeitos da ausência e presença da
            célula de Renshaw análises espectrais.
            Linhas pretas e vermelhas
            são os resultados de simulações sem e com CRs, respectivamente.
            A linha azul representa uma situação intermediária e não será
            reproduzida aqui \cite{williams09}.
             \subref{fig:met_williams09a} Coerência córtico-muscular.
             \subref{fig:met_williams09b} Espectro de potência da força muscular.
            }
	\label{fig:met_williams09}
\end{figure}

\subsection{Estudos de contrações isométricas}
Os forças de inibição recorrente e a forma como as entradas são
definidas para cada caso foram as mesmas das descritas na seção 
anterior.
A ativação do núcleo motor nessas simulações foi
realizada por meio de fibras descendentes com taxa de disparos 
constantes e suficiente para gerar valores de força próximos à CVM.
Essa taxa foi mantida por 500 ms.
Essa configuração permitiu que a derivada da força, ou seja, sua 
sensibilidade ao comando descendente, pudesse ser avaliada para uma
situação de fuga de uma ameaça repentina.

Outros cenários analisados
foram os da manutenção de 5\% e 70\% da CVM por meio de fibras
descendentes com taxas de disparo de potenciais de ação constantes e 
suficientes para recrutar uma porcentagem de MNs próxima à apropriada
\cite{walmsley78}. Essas simulações foram realizadas 10 vezes para cada
caso. O coeficiente de variação da força muscular 
gerada foi calculado pela equação (\ref{eq:cv}) mostrada abaixo:

\begin{equation}
    \text{Coeficiente de variação } (\%) = \frac{\text{desvio padrão da força}}{\text{média da força}}\cdot 100
    \label{eq:cv}
\end{equation}

Nesse caso, as simulações tiveram duração de 2 s e os primeiros 500 ms 
foram removidos para evitar a presença de componentes transitórios
no sinal.

Os cenários abordados na seção \ref{sec:met_psd} também foram analisados aqui.
O valor das frequências de disparos foram
ajustados como na seção \ref{sec:met_onion}. Em todos eles, os graus de 
sincronia foram calculados de acordo com o trabalho de
\citeonline{golomb01} e comparados.

O coeficiente de sincronia foi calculado da seguinte forma: Primeiramente,
a média do potencial membrana do soma dos \numMN MNs que dispararam em uma simulação 
foi dada como 

\begin{equation}
    \vMean(t) = \frac{1}{N}\sum_{i=1}^{N}\vInd(t)
\end{equation}

sendo sua variância calculada como 

\begin{equation}
    \statVar = \langle \vMean(t)^2\rangle_t - \langle \vMean(t)\rangle_t^2
\end{equation}

O operador $\langle\cdot\rangle_t$ denota uma média no tempo. Em seguida, 
um fator de normalização que leva em consideração cada MN pode ser
calculado como 

\begin{equation}
    \sigma_i^2 = \langle V_i(t)^2\rangle_t - \langle V_i(t)\rangle_t^2
\end{equation}

Por fim, obtém-se o coeficiente 

\begin{equation}
    \syncCoef = \frac{\sigma^2}{\frac{1}{N}\sum_{i=1}^N\sigma^2_i}
\end{equation}

em que $0\le\chi^2\le 1$. Sendo assim, valores mais próximos de 1 indicam
uma atividade mais sincronizada do núcleo motor.

\subsection{Distorções na saída do núcleo motor}
Nas simulações descritas aqui, as entradas sinápticas agindo sobre o
núcleo motor foram: fibras descendentes com taxas de disparos com determinado
valor médio e moduladas por 3 senoides; ruídos independentes
agindo sob cada MN. As senoides usadas para a modulação tiveram frequências
de 0.5, 1 e 2.5 Hz, tendo amplitudes de 10, 5 e 2.5 Hz, respectivamente.
Por sua vez, os
ruídos, gerados por processos Poisson, tiveram condutância sináptica
máxima de 12 $\mu$S e taxa de disparos de 50/s.

As simulações envolveram
situações com e sem inibição recorrente. O valor médio da taxa de disparo
das fibras descendentes na ausência das CRs foi ajustado para recrutar
cerca de 130 MNs. Em simulações com CRs, o valor médio foi aumentado para
que fossem geradas forças com valor médio dentro de uma faixa de
10 \% em torno da força média
gerada na situação anterior. Dessa forma, os valores utilizados foram de
300 e 438 potenciais de ação por segundo.

No total, foram realizadas 30 simulações com 10 s de duração cada, sendo
os primeiros 2 s dos
sinais gerados removidos para eliminar possíveis respostas transitórias
nas análises subsequentes. A representação no domínio da frequência
da força muscular resultante foi obtida por meio da transformada de Fourier. 
Além disso, denominando \Bi como o pico do módulo do espectro da força em
0.5 ($i=1$), 1 ($i=2$) e 2.5 ($i=3$) Hz e \Bj como o das outras frequências,
os seguintes quantificadores foram calculados:

\begin{equation}
    \qum=\frac{B_1}{B_2}
    \label{eq:b1b2}
\end{equation}

\begin{equation}
    \qdois=\frac{B_1}{B_3}
    \label{eq:b1b3}
\end{equation}

\begin{equation}
    \qtres=\frac{\sqrt{B_1^2+B_2^2+B_3^2}}{\sqrt{\sum B_j^2}}
    \label{eq:pbipbni}
\end{equation}

Nessa última expressão, a somatória foi realizada apenas até as
componentes em frequência de 6 Hz. Nota-se que na entrada as relações de
amplitude entre a segunda harmônica e a fundamental é igual a 2 e 
entre a quinta harmônica e a fundamental é 4.

Para representar o sinal de ativação dos
músculos pelos MNs recrutados, foi utilizado um trem de disparos
cumulativo (CST, do inglês \textit{cumulative spike train})
em que os instantes de disparos de 5 MNs foram utilizados para formar
um novo trem de disparos que espelha a contribuição total e temporal
do conjunto de MNs selecionados. O CST foi filtrado
por um filtro passa-baixas de quarta ordem, do tipo \textit{Butterworth} e
com frequência de corte de 10 Hz.
