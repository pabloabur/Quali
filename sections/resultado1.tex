\chapter{Resultados e discussões}
\section{Desempenho computacional}
Na Figura \ref{fig:clustera} são apresentados os valores de \textit{Speedup} das
simulações com diferentes números de processadores. Como se pode perceber, foi 
possível alcançar uma diminuição no tempo de execução com as simulações feitas em
paralelo, de forma que os valores de \textit{Speedup} aumentam de forma linear,
aproximadamente. Na Figura \ref{fig:clusterb}, por sua vez, são apresentados os valores das
eficiências calculadas. Esses valores são
bem próximos para 2, 4 e 8 processos, mas uma queda começa a se tornar visível em
16 processos, sugerindo que, a partir desse número, a queda de eficiência se 
acentue.

\begin{figure}[ht]
    \centering
    \subfloat[][]{
        \label{fig:clustera}
        \includegraphics[scale=0.3]{linear}
    }
    ~ 
    \subfloat[][]{
        \label{fig:clusterb}
        \includegraphics[scale=0.3]{efs}
    }
    \caption[Resultados de aceleração e eficiência em função do número de processadores]{
        \subref{fig:clustera} Os círculos representam o \textit{Speedup} obtido para cada
        número de processador utilizado. A reta em azul mostra uma regressão linear dos
        resultados. \subref{fig:clusterb} eficiência em função do número de processadores.
         }
\end{figure}

Outro resultado sobre desempenho computacional obtido foi o de tempo de
execução com as matrizes de condutância alteradas no Python. Como mostrado na 
Tabela \ref{tab:matrixG}, não é observada uma melhora de desempenho quando se 
usa a \Gn para 10 MNs. Entretanto, a medida em que se aumentam
o número de elementos neuronais para 50, 100 e 400 MNs, esta implementação
apresenta uma diminuição do tempo de execução de aproximadamente 23\%, 29\% e
26\% em relação à \Ga com
10, 50, 100 e 400 MNs, respectivamente. Isso sugere que as otimizações trazidas
por essa estratégia só são vantajosas para simulações que envolvam \Gn
relativamente grandes. Como essas matrizes são esparsas, algoritmos que se
aproveitam dessa estrutura podem ser usados para reduzir ainda mais o tempo de
simulação.

\begin{table}[ht]
\caption{Tempo de execução das simulações relacionadas 
         à matriz de condutância para diferentes quantidades de MNs.}
\label{tab:matrixG}
\centering
    \begin{tabular}{ccccc}\hline 
        & 10 MNs & 50 MNs & 100 MNs & 400 MNs \\ \hline 
        \Ga & 5.21 s & 21.22 s & 42.34 s & 170.97 s \\ 
        \Gn & 5.63 s & 16.50 s & 30.01 s & 125.31 s \\ 
	\hline
    \end{tabular}
\end{table}

Os resultados mostrados anteriormente são positivos, mas possuem muitas
limitações. Em primeiro lugar, apesar das melhoras obtidas com a matriz
\Gn, a diferença de tempo de execução entre as versões Java e Python
ainda são muito grandes e outras soluções precisariam ser exploradas
para diminuir essa discrepância.

Em segundo lugar, é preciso enfatizar que os MNs das simulações
realizadas no \textit{cluster} não recebem nenhuma entrada sináptica
de INs. A paralelização desse tipo de configuração é
facilmente obtida e dificilmente apresenta resultados negativos, pois,
como as unidades motoras são independentes umas das outras, os
processos podem executar em paralelo sem a necessidade de se comunicar. 
Em um cenário mais realista, como o que está sendo estudado na Figura
\ref{fig:circuit}, MNs em um processo podem precisar receber informações
geradas em outro. Por causa da alta complexidade de conexões
sinapticas, seriam necessárias muitas comunicações entre processos
e isso poderia causar uma diminuição significativa nos valores de
\textit{Speedup}.

Isso, de qualquer forma, não tira a validade desse resultado, visto
que existem maneiras de paralelizar simuladores de redes neuronais
complexas mantendo um bom desempenho computacional \cite{morrison05}.
Entretanto, pode-se perceber que os resultados obtidos no \textit{cluster},
em essência, poderiam ser reproduzidos em computadores comuns por meio
da utilização de \textit{threads} ou processos. O uso destas estratégias,
na verdade, seria preferível à utilização de um \textit{cluster}, pois
envolvem menos alterações na estrutura do código do simulador e
possibilitam que outras pessoas interessadas em utilizar esse
\textit{software} possam fazer simulações com um bom desempenho
computacional em seus próprios computadores.

A utilização de \textit{threads} no Python, entretanto, não é
possível por causa do \textit{Global Interpreter Lock} (GIL). Esse
mecanismo faz com que apenas uma \textit{thread} exista por processo.
Uma alternativa para essa limitação é o uso de processos para realizar
a paralelização do código. Esse recurso pode ser explorado no Python
através da biblioteca \textit{Multiprocessing} e pode trazer melhoras
significativas, especialmente quando há a possibilidade de se trabalhar
com memória compartilhada. O código do simulador, no entanto, teria que
passar por grandes modificações e sua estrutura de orientação a objetos
não é muito compatível com essa biblioteca. Além disso, a elevado 
volume de comunicações entre processos aqui também seria um gargalo.

Sendo assim, de acordo com as observações feitas, convém propor outras
estratégias para alcançar um aumento no desempenho computacional. Para
esse fim, o Cython surge como uma boa alternativa e será explorado 
nesse trabalho, já que seu uso pode ocasionar em tempos de execução
muitas vezes similares ao de um código escrito em C \cite{gorelick14}.
Vale notar que o uso de \textit{clusters} ainda seria uma boa solução,
mas por causa da dificuldade de tal implementação e da existência de
outras opções, esta é postergada para trabalhos futuros.

%\begin{table}[ht!]
%\caption{Tempo de execução das simulações relacionadas 
%         à matriz de condutância para diferentes tempos simulados.}
%\label{tab:matrixGt}
%\centering
%    \begin{tabular}{cccc}\hline 
%        & 200 ms & 500 ms & 1000 ms \\ \hline 
%        $G_c$ & 21.52 s & 53.03129 s &  s \\ 
%        $G_g$ & 16.55 s & 41.15 s &  s \\ 
%	\hline
%    \end{tabular}
%\end{table}

\section{Parametrizações}
\subsection{Potencial excitatório pós sinápico nas células de Renshaw}
O resultado mostrado na Figura
\label{sec:res_epsp}
\ref{fig:RCepsp} foi obtido com $R_m=\text{2500 }\Omega\text{cm}^2$ . O PEPS é
iniciado em 10.35 ms e atinge o pico em 16.90 ms, configurando, assim, um
tempo de subida de 6.55 ms.

O valor de aproximadamente 4.5\% do pico do PEPS foi atingido 55 ms após
a ativação da sinapse.
Esta abordagem para analisar a duração foi utilizada por \citeonline{maltenfort98},
que obtiveram 10\% do pico em 55 ms.

\begin{figure}[ht!]
	\center
	\includegraphics[scale=0.8]{EPSP.eps}
    \caption[PEPS em uma CR.]{Potencial excitatório pós sináptico 
        em uma célula de Renshaw.}
	\label{fig:RCepsp}
\end{figure}

Em relação ao PEPS, existem, ainda, aspectos sobre a convergência
de axônios motores e a força de entrada sináptica dependente do tipo de
MN. Essas características foram analisadas junto com estudos
sobre conectividade e serão abordadas na seção \ref{sec:conn}. A utilização
de outros valores de resistência para diminuir a amplitude de PEPS, como
feito por \citeonline{williams09}, alteraram
significativamente as características de disparos mostrados na próxima
seção e, por isso, não foram adotados.

O tempo de subida foi um pouco menor do que o de \citeonline{williams09}, 
mas ainda está de acordo com o que foi descrito na literatura \cite{walmsley81}.
Uma alteração na resistência específica mudaria
o tempo de subida aqui apresentado, mas isso teria um impacto negativo
na duração do PEPS. Portanto, a parametrização realizada foi tomada
para satisfazer razoavelmente cada característica.

\subsection{Características dos disparos das células de Renshaw}
Usando o $R_m$ obtido na seção anterior,
$a=\text{1753.8+16756 }\mu\text{m}^2$ e considerando que $I_r=\text{0.5 }$ nA,
a Equação (\ref{eq:vth}) resulta em $V_l=\text{6.75 }$ mV.
Além disso,
considerando $d=27 \mu$m, a Equação (\ref{eq:area}) fornece o valor de
$l=\text{218.2168 }\mu$m.
Com os resultados obtidos, a resistência de entrada $\ri=\frac{R_m}{a}$
resultante foi de 13.50 M$\Omega$. Esse valor é condizente com o fato
de que as CRs são menores do que os menores MNs.

Com esses parâmetros, torna-se possível parametrizar a AHP e a curva
$F\times I$.
As variáveis de transição relacionadas com a
dinâmica dos canais de potássio rápido foram aumentadas para evitar
algum tipo de somação de suas correntes. 
A partir de então, optou-se por utilizar apenas
os canais de potássio lento, com \alphaq e \betaq,
para se obter as taxas de disparos e adaptação apropriados.

Considerando uma sequência de potenciais
de ação, uma diminuição no valor de $\alpha_Q$ faz com que
a exponencial que dita a velocidade de ativação do canal seja mais lenta.
Reciprocamente,
uma diminuição em $\beta_Q$ com o intuito de retardar o fechamento permite que 
haja uma superposição nos valores da variável de transição \qt,
fazendo com que exista uma corrente iônica
abaixando o potencial de membrana para o equilíbrio do canal de potássio
lento (-10 mV). Esse comportamento é mostrada na Figura \ref{fig:qt}. 
Inicialmente, essa corrente é relativamente pequena, mas
ela cresce de forma cumulativa. Esse fenômeno, então, gera 
uma adaptação na frequência de disparo das CRs.

\begin{figure}[ht!]
	\center
	\includegraphics[scale=0.8]{qt.eps}
    \caption[Evolução temporal da variável de transição $q(t)$.]{
        Evolução temporal da variável de transição $q(t)$.}
	\label{fig:qt}
\end{figure}

Em uma bateria de simulações,
os valores de $\alpha_Q$ e $\beta_Q$ foram ajustados com base nas
considerações do parágrafo anterior até se obter
uma AHP e uma curva $F\times I$ semelhantes à da Figura \ref{fig:HP79}.
Feito isso, a amplitude do AHP foi obtida alterando as densidades
das condutâncias de potássio rápida e lenta. A diferença
nos disparos introduzida por isso era verificada e corrigida iterativamente.

Os disparos espontâneos da CR modelada são mostrados na Figura \ref{fig:spont}.
A curva $F\times I$ obtida, por sua vez, é apresentada na Figura
\ref{fig:RCfxi}, juntamente com 
detalhes sobre a AHP, na Figura \ref{fig:RCahp}.
A saturação observada foi 
causada pela período refratário absoluto do neurônio, que é de 1 ms.
O pico da AHP
observado foi de -2.4 mV e sua duração foi de aproximadamente 33 ms.

\begin{figure}[ht]
    \centering
    \subfloat[][]{
	\label{fig:RCfxi}
	\includegraphics[scale=0.5]{FxI.eps}
    }
    \subfloat[][]{
	\label{fig:RCahp}
	\includegraphics[scale=0.5]{AHP.eps}
    }
    \hspace{-1cm}
    \caption[Característica de disparos da CR]{
        Característica de disparos da CR
        \subref{fig:RCfxi} Curva de frequência de disparo
        \textit{versus} corrente injetada.
        \subref{fig:RCahp} Pós hiperpolarização.
         }
    \label{fig:fxiahp}
\end{figure}

\begin{figure}[ht!]
	\center
	\includegraphics[scale=0.8]{spont.eps}
    \caption[Disparos espontâneos de uma CR.]{Disparos espontâneos de uma CR.}
	\label{fig:spont}
\end{figure}

A AHP e o disparo espontâneo foram semelhantes aos dos estudos
eletrofisiológicos.
A curva $F\times I$ apresentada se aproximou do que foi descrito na literatura, 
mas os três primeiros intervalos foram mais rápido do que o esperado,
especialmente o segundo e o terceiro. A curva do regime estacionário,
por sua vez, foi similar à experimental. De forma geral, outras
configurações foram encontradas para corrigir os problemas encontrados,
mas isso traria impactos negativos para a AHP ou para os potenciais
de ação da CR.  
Além disso, o tempo de duração da adaptação, que é maior para correntes mais
altas, foi sempre menor no modelo aqui descrito.
Isso é ilustrado na Figura \ref{fig:FxIcomp}.

\begin{figure}[ht]
    \centering
    \subfloat[][]{
        \label{fig:refmemb}
        \includegraphics[scale=0.8]{refmemb}
    }
    \hspace{-1cm}
    \subfloat[][]{
        \label{fig:resmemb}
        \includegraphics[scale=0.4]{FxI_RC.eps}
    }
    \caption[Comparação dos potenciais de membrana para uma corrente injetada
        de 12 nA]{
        Comparação dos potenciais de membrana para uma corrente injetada
        de 12 nA. \subref{fig:refmemb}  Tempo da adaptação em uma
        CR tem uma duração de aproximadamente 30 ms \cite{hultborn79}.
        \subref{fig:resmemb} Resultado obtido pelo modelo de uma CR nas
        mesmas condições.
         }
    \label{fig:FxIcomp}
\end{figure}

Alguns fatores podem explicar as divergências encontradas. Os principais
mecanismos de adaptação, além do utilizado aqui, envolvem 
canais iônicos relacionados com inativação de correntes de despolarização,
concentração intracelular de cálcio e dinâmicas variadas de correntes 
de potássio \cite{benda03}. Esses canais, contudo, não estão implementados
no ReMoto, fazendo com que haja menos opções para se reproduzir essa 
característica.

De fato, estudos sugerem que as CRs possuem outros tipos de canais iônicos.
Sabe-se que correntes de hiperpolarização e de potássio dependente
de cálcio são responsáveis por importantes características
de disparos desses neurônios, como, por exemplo, taxas de disparos
\cite{perry15}. A utilização de dados disponíveis para implementação 
desses canais no modelo, entretanto, não é muito apropriada por dois
motivos: 

\begin{itemize}
    \item Estes dados foram obtidos de ratos e não há garantias que as CRs
          desses animais tenham as mesmas características das de gatos,
          que é a principal fonte de dados utilizada nesse estudo.
    \item Como as conexões sinápticas relacionadas com as CRs são diferentes
          em cada estágio de desenvolvimento do rato \cite{alvarez07}
          e os dados em questão foram obtidos em um estágio pós
          natal precoce, não se pode garantir que estas propriedades sejam
          as mesmas das CRs utilizadas aqui.
\end{itemize}

\subsection{Potencial inibitório pós sináptico em motoneurônios causados pela
            célula de Renshaw}
Após sucessivas simulações, em que ajustes foram sendo feitos de forma
empírica, o resultado final obtido é mostrado na 
Figura \ref{fig:PIPSres}. Os picos foram de -26.21 $\mu$V, -14.76 $\mu$V e
-7.13 $\mu$V para MNs do tipo S, FR e FF, respectivamente. Os resultados
estiveram, portanto, de acordo com as referências utilizadas.

\begin{figure}[ht!]
	\center
	\includegraphics[scale=0.8]{IPSP.eps}
    \caption[PIPS de uma CR.]{Potencial inibitório pós sináptico
        de célula de Renshaw em diferentes tipos de motoneurônios.}
	\label{fig:PIPSres}
\end{figure}

\subsection{Distribuição e amplitudes da inibição recorrente}
\label{sec:conn}
Após uma série de simulações, o valor de $\bar{g}_{max_{FF}}$ que mostrou os
resultados mais apropriados de acordo com a literatura foi 15 nS.
O efeito da utilização desse parâmetro na distribuição topográfica dos
PIPS recorrentes pode ser visto na Figura \ref{fig:mchammdecay}.

\begin{figure}[ht!]
	\center
	\includegraphics[scale=0.8]{mchammdecay.eps}
    \caption[Distribuição topográfica de potenciais inibitórios
            pós sinápticos recorrentes.]{Distribuição topográfica de
            potenciais inibitórios pós sinápticos recorrentes. Cada
            ponto representa a amplitude desses potenciais após o estímulo
            de outro motoneurônio, localizado em zero na abcissa.
            Se observado em um motoneurônio
            rostral (caudal) ao motoneurônio estimulado, é apresentado
            na parte negativa (positiva) da abcissa.}
	\label{fig:mchammdecay}
\end{figure}

O
padrão de decaimento com distância foi semelhantes ao que foi apresentado
na Figura \ref{fig:met_RIPSP}. A amplitude dos PIPS recorrentes entre pares
distantes e próximos
foi, em média, -19.88 $\mu$V e -66.56 $\mu$V, respectivamente.

Sabe-se que a amplitude de PIPS recorrentes entre pares de MNs próximos
é relativamente variável, sendo observados valores de -40 $\mu$V e
-280 $\mu$V para uma mesma distância, por exemplo. Os mecanismos
responsáveis por essa
característica, entretanto, são especulativos \cite{mccurdy94}.
Nos resultados aqui obtidos, esta variabilidade não foi observada
e, por isso, a média de PIPS recorrentes
para pares de MNs próximos foi maior do que o esperado.

Vale notar que outros valores maiores de $\bar{g}_{max_{FF}}$ geraram resultados
semelhantes, mas com amplitudes máximas e valores médios elevados.
Menores $\bar{g}_{max_{FF}}$ por sua vez, fariam com que o efeito 
das CRs fosse muito baixo. Sendo assim, o valor de condutância adotado
fornece um equilíbrio razoável dos resultados.

\subsection{Característica dinâmica e depressão pós sináptica
            da célula de Renshaw}
\label{sec:res_dyn}
Para que os resultados de \citeonline{hultborn79} possam ser
reproduzidos, 
valores elevados de \vari e $\tau_d$, tais como 0.9 e 
400, respectivamente, foram necessários.
Isso, entretanto, faz com
que as características dinâmicas da CR sejam comprometidas, como
visto na Figura \ref{fig:dynamic}. 

\begin{figure}[ht]
	\center
	\includegraphics[scale=0.6]{dynamic.eps}
    \caption[Características dinâmicas de uma célula de Renshaw modelada.]{
             Características dinâmicas de uma célula de Renshaw modelada.
             A frequência do estímulo, inicialmente
             de 5 Hz, foi abruptamente aumentada para um dos valores
             indicados na legenda, em Hz.
            }
	\label{fig:dynamic}
\end{figure}

Pode-se perceber que
as respostas de algumas frequências estão muito próximas e a taxa
de disparo foi diminuída a valores muito baixos. Isto está em
desacordo com dados
fornecidos na literatura \cite{ross82,uchiyama03a}. A razão pela
qual o modelo também não reproduziu esses resultados
experimentais na ausência da dinâmica das sinapses é, possivelmente,
a mesma apresentada por meio da Figura \ref{fig:FxIcomp}. Um 
aumento da condutância sináptica dos MNs sob as CRs traria resultados
positivos, mas também afetaria negativamente as simulações da seção
\ref{sec:res_stat}.

Sendo assim, optou-se por não utilizar esse mecanismo de depressão
sináptica no modelo. Isso implica que em simulações que envolvam
uma parte transiente da resposta da CR, como algumas realizadas na
seção \ref{sec:danger}, é de se esperar que a inibição recorrente 
seja maior, mesmo que por um breve período. Essa consideração é
condizente com investigações experimentais realizadas por
Sawicki\footnote{SAWICKI, P. \textbf{Dynamisches Verhalten der rekurrenten
Hemmung monosynaptischer Reflexe}. Dissertação. Alemanha:
Universidade de Düsseldorf, 1984.}
(1984, apud \citeauthor{windhorst90}, 1982, p. 154).

Vale citar um estudo recente mostrando que, para baixas frequências
de estimulação, essa depressão quase não altera as correntes 
pós sinápticas geradas \cite{moore15}. Esse resultado vai de encontro
com os de \citeonline{hultborn79} e
deve ser analisado com cautela pois foi realizado em ratos.

Os parâmetros apresentados nessa seção, assim como seus valores, são
sumarizados na Tabela \ref{tab:params_final}.

\begin{table}[ht!]
\caption{Principais parâmetros das células de Renshaw e seus valores.}
\label{tab:params_final}
\centering
    \begin{tabular}{c C{3cm} C{3cm}}\hline 
	Parâmetro & Valor & Unidade \\ \hline 
    Resistência específica de membrana & 2500  & $\Omega\text{cm}^2$ \\
    Capacitância específica de membrana & 1  & $\mu\text{Fcm}^{-2}$ \\
    Corrente de reobase & 0.5 & nA \\
    Diâmetro & 27 & $\mu$m \\
    Comprimento & 218.2168 & $\mu$m \\
    Limiar & 6.7532 & mV  \\ 
    $\alpha_N$ & 6 & ms$^{-1}$  \\ 
    $\beta_N$ & 0.5 & ms$^{-1}$ \\ 
    $\alpha_Q$ & 0.007 & ms$^{-1}$  \\ 
    $\beta_Q$ & 0.02 & ms$^{-1}$  \\ 
    Condutância máxima do canal de potássio lento & 1100 & mS/cm$^2$ \\
    Condutância máxima do canal de potássio rápido & 3.8 & mS/cm$^2$ \\
    Condutância máxima CR - MN S & 119 & nS \\
    Condutância máxima CR - MN FR & 119 & nS \\
    Condutância máxima CR - MN FF & 94 & nS \\
    Condutância máxima do ruído & 14 & nS \\
    Condutância máxima MN S - CR & 6.81 & nS \\
    Condutância máxima MN FR - CR & 8.33 & nS \\
    Condutância máxima MN FF - CR & 15 & nS \\
	\hline
    \end{tabular}
\end{table}
